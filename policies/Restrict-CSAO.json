{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Sid": "DenyActionsOnCSAOResources",
            "Effect": "Deny",
            "Action": [
                "lambda:AddLayerVersionPermission",
                "lambda:AddPermission",
                "lambda:CreateAlias",
                "lambda:CreateCodeSigningConfig",
                "lambda:CreateEventSourceMapping",
                "lambda:CreateFunction",
                "lambda:DeleteAlias",
                "lambda:DeleteCodeSigningConfig",
                "lambda:DeleteEventSourceMapping",
                "lambda:DeleteFunction",
                "lambda:DeleteFunctionCodeSigningConfig",
                "lambda:DeleteFunctionConcurrency",
                "lambda:DeleteFunctionEventInvokeConfig",
                "lambda:DeleteLayerVersion",
                "lambda:DeleteProvisionedConcurrencyConfig",
                "lambda:Invoke",
                "lambda:InvokeAsync",
                "lambda:PublishLayerVersion",
                "lambda:PublishVersion",
                "lambda:PutFunctionCodeSigningConfig",
                "lambda:PutFunctionConcurrency",
                "lambda:PutFunctionEventInvokeConfig",
                "lambda:PutProvisionedConcurrencyConfig",
                "lambda:RemoveLayerVersionPermission",
                "lambda:RemovePermission",
                "lambda:TagResource",
                "lambda:UntagResource",
                "lambda:UpdateAlias",
                "lambda:UpdateCodeSigningConfig",
                "lambda:UpdateEventSourceMapping",
                "lambda:UpdateFunctionCode",
                "lambda:UpdateFunctionConfiguration",
                "lambda:UpdateFunctionEventInvokeConfig",
                "logs:AssociateKmsKey",
                "logs:CancelExportTask",
                "logs:CreateExportTask",
                "logs:CreateLogGroup",
                "logs:CreateLogStream",
                "logs:DeleteDestination",
                "logs:DeleteLogGroup",
                "logs:DeleteLogStream",
                "logs:DeleteMetricFilter",
                "logs:DeleteQueryDefinition",
                "logs:DeleteResourcePolicy",
                "logs:DeleteRetentionPolicy",
                "logs:DeleteSubscriptionFilter",
                "logs:DisassociateKmsKey",
                "logs:PutDestination",
                "logs:PutDestinationPolicy",
                "logs:PutLogEvents",
                "logs:PutMetricFilter",
                "logs:PutQueryDefinition",
                "logs:PutResourcePolicy",
                "logs:PutRetentionPolicy",
                "logs:PutSubscriptionFilter",
                "logs:TagLogGroup",
                "logs:TestMetricFilter",
                "logs:UntagLogGroup",
                "events:DeleteRule",
                "events:DisableRule",
                "events:EnableRule",
                "events:PutEvents",
                "events:PutPermission",
                "events:PutRule",
                "events:PutTargets",
                "events:RemovePermission",
                "events:RemoveTargets",
                "events:TestEventPattern",
                "dynamodb:BatchExecuteStatement",
                "dynamodb:BatchGetItem",
                "dynamodb:BatchWriteItem",
                "dynamodb:CreateBackup",
                "dynamodb:CreateGlobalTable",
                "dynamodb:CreateTable",
                "dynamodb:DeleteBackup",
                "dynamodb:DeleteItem",
                "dynamodb:DeleteTable",
                "dynamodb:DescribeBackup",
                "dynamodb:DescribeContinuousBackups",
                "dynamodb:DescribeContributorInsights",
                "dynamodb:DescribeEndpoints",
                "dynamodb:DescribeExport",
                "dynamodb:DescribeGlobalTable",
                "dynamodb:DescribeGlobalTableSettings",
                "dynamodb:DescribeKinesisStreamingDestination",
                "dynamodb:DescribeLimits",
                "dynamodb:DescribeTable",
                "dynamodb:DescribeTableReplicaAutoScaling",
                "dynamodb:DescribeTimeToLive",
                "dynamodb:DisableKinesisStreamingDestination",
                "dynamodb:EnableKinesisStreamingDestination",
                "dynamodb:ExecuteStatement",
                "dynamodb:ExecuteTransaction",
                "dynamodb:ExportTableToPointInTime",
                "dynamodb:GetItem",
                "dynamodb:ListBackups",
                "dynamodb:ListContributorInsights",
                "dynamodb:ListExports",
                "dynamodb:ListGlobalTables",
                "dynamodb:ListTables",
                "dynamodb:ListTagsOfResource",
                "dynamodb:PutItem",
                "dynamodb:Query",
                "dynamodb:RestoreTableFromBackup",
                "dynamodb:RestoreTableToPointInTime",
                "dynamodb:Scan",
                "dynamodb:TagResource",
                "dynamodb:TransactGetItems",
                "dynamodb:TransactWriteItems",
                "dynamodb:UntagResource",
                "dynamodb:UpdateContinuousBackups",
                "dynamodb:UpdateContributorInsights",
                "dynamodb:UpdateGlobalTable",
                "dynamodb:UpdateGlobalTableSettings",
                "dynamodb:UpdateItem",
                "dynamodb:UpdateTable",
                "dynamodb:UpdateTableReplicaAutoScaling",
                "dynamodb:UpdateTimeToLive"
            ],
            "Resource": [
                "arn:aws:lambda:*:*:function:MarriottCSAO*",
                "arn:aws:logs:*:*:log-group:/aws/events/MarriottCSAO*",
                "arn:aws:logs:*:*:log-group:/aws/lambda/MarriottCSAO*",
                "arn:aws:events:*:*:rule/MarriottCSAO*",
                "arn:aws:events:*:*:event-bus/MarriottCSAO*",
                "arn:aws:dynamodb:*:*:table/MarriottCSAO*"
            ],
            "Condition": {
                "ArnNotLike": {
                    "aws:PrincipalARN": [
                        "arn:aws:iam::*:role/mi-csao",
                        "arn:aws:iam::*:role/AWSCloudFormationStackSetAdministrationRole",
                        "arn:aws:iam::*:user/dbhar302"
                    ]
                }
            }
        },
        {
            "Sid": "RestrictAccessToCsaoEC2Instance",
            "Effect": "Deny",
            "Action": [
                "ec2:RunInstances",
                "ec2:StartInstances",
                "ec2:StopInstances",
                "ec2:TerminateInstances"
            ],
            "Resource": "arn:aws:ec2:us-east-2:883113265457:instance/i-0105548a9b42659ac",
            "Condition": {
                "StringNotEquals": {
                    "aws:PrincipalArn": [
                        "arn:aws:iam::883113265457:role/mi-csao"
                    ]
                }
            }
        }
    ]
}