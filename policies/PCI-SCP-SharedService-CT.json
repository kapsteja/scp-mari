{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Effect": "Deny",
            "Action": "*",
            "Resource": [
                "*"
            ],
            "Condition": {
                "StringLike": {
                    "aws:PrincipalArn": [
                        "arn:aws:iam::*:root"
                    ]
                }
            }
        },
        {
            "Effect": "Deny",
            "Action": [
                "ec2:DeleteFlowLogs",
                "logs:DeleteLogGroup",
                "logs:DeleteLogStream",
                "iam:AttachUserPolicy",
                "iam:CreateAccessKey",
                "iam:CreateUser",
                "iam:PutUserPolicy",
                "iam:DeleteSAMLProvider",
                "iam:AttachRolePolicy",
                "iam:DeleteRole",
                "iam:DeleteRolePermissionsBoundary",
                "iam:DeleteRolePolicy",
                "iam:DetachRolePolicy",
                "iam:PutRolePermissionsBoundary",
                "iam:PutRolePolicy",
                "iam:UpdateAssumeRolePolicy",
                "iam:UpdateRole",
                "iam:UpdateRoleDescription",
                "organizations:LeaveOrganization",
                "organizations:DeleteOrganization",
                "config:DeleteConfigurationAggregator",
                "config:DeleteConfigurationRecorder",
                "config:DeleteDeliveryChannel",
                "config:DeleteRetentionConfiguration",
                "config:PutConfigurationAggregator",
                "config:PutConfigurationRecorder",
                "config:PutDeliveryChannel",
                "config:PutRetentionConfiguration",
                "config:StopConfigurationRecorder"
            ],
            "Resource": [
                "*"
            ],
            "Condition": {
                "StringNotLike": {
                    "aws:PrincipalArn": [
                        "arn:aws:iam::*:role/AWSCloudFormationStackSetExecutionRole",
                        "arn:aws:iam::*:role/AWSCloudFormationStackSetExecutionRoleCSAO",
                        "arn:aws:iam::*:role/AWSReservedSSO_AWSAdministratorAccess_*",
                        "arn:aws:iam::*:role/AWSReservedSSO_mi-ps-agrp-micp-aws-admin_*",
                        "arn:aws:iam::*:role/stacksets-exec-*",
                        "arn:aws:iam::*:role/aws-controltower-AdministratorExecutionRole",
                        "arn:aws:iam::*:role/AWSControlTowerExecution",
                        "arn:aws:iam::*:role/mi-iaac",
                        "arn:aws:iam::*:role/mi-breakglass",
                        "arn:aws:iam::256177873118:role/aap-nonprod-role",
                        "arn:aws:iam::256177873118:role/mi-aap-prod-role",
                        "arn:aws:iam::256177873118:role/mi-ansible-aap",
                        "arn:aws:iam::256177873118:role/TFC-ECS-Agent-ecs-tfc-agent-task-init-role",
                        "arn:aws:iam::256177873118:role/TFC-ECS-Agent-ecs-tfc-agent-role",
                        "arn:aws:iam::*:role/tfc-mi-sre-iaac",
                        "arn:aws:iam::*:role/aws-reserved/sso.amazonaws.com/AWSReservedSSO_mi-ps-agrp-micp-aws-admin_*",
                        "arn:aws:iam::*:role/mi-gami-role"
                    ]
                }
            }
        },
        {
            "Effect": "Deny",
            "NotAction": [
                "access-analyzer:*",
                "apigateway:*",
                "appflow:*",
                "aws-marketplace:*",
                "appstream:*",
                "athena:*",
                "chime:*",
                "clouddirectory:*",
                "cloudfront:*",
                "cloudwatch:*",
                "logs:*",
                "events:*",
                "cognito-idp:*",
                "cognito-identity:*",
                "cognito-sync:*",
                "comprehend:*",
                "comprehendmedical:*",
                "connect:*",
                "detective:*",
                "devops-guru:*",
                "docdb-elastic:*",
                "dynamodb:*",
                "dax:*",
                "autoscaling:*",
                "ec2:*",
                "imagebuilder:*",
                "ec2-instance-connect:*",
                "ec2messages:*",
                "ecr:*",
                "ecr-public:*",
                "ecs:*",
                "elasticfilesystem:*",
                "eks:*",
                "finspace:*",
                "forecast:*",
                "freertos:*",
                "frauddetector:*",
                "fsx:*",
                "guardduty:*",
                "healthlake:*",
                "inspector:*",
                "kinesisanalytics:*",
                "kinesis:*",
                "kinesisvideo:*",
                "lex:*",
                "geo:*",
                "macie2:*",
                "kafka-cluster:*",
                "memorydb:*",
                "mq:*",
                "neptune-db:*",
                "es:*",
                "personalize:*",
                "mobiletargeting:*",
                "polly:*",
                "redshift:*",
                "redshift-data:*",
                "redshift-serverless:*",
                "rekognition:*",
                "route53:*",
                "s3:*",
                "s3-object-lambda:*",
                "s3-outposts:*",
                "sagemaker:*",
                "sdb:*",
                "ses:*",
                "sns:*",
                "sqs:*",
                "swf:*",
                "textract:*",
                "timestream:*",
                "transcribe:*",
                "translate:*",
                "vpc-lattice:*",
                "vpc-lattice-svcs:*",
                "workdocs:*",
                "workmail:*",
                "worklink:*",
                "workspaces:*",
                "workspaces-web:*",
                "amplify:*",
                "amplifybackend:*",
                "amplifyuibuilder:*",
                "appmesh:*",
                "appmesh-preview:*",
                "apprunner:*",
                "appsync:*",
                "auditmanager:*",
                "backup:*",
                "backup-gateway:*",
                "backup-storage:*",
                "batch:*",
                "acm:*",
                "acm-pca:*",
                "chatbot:*",
                "servicediscovery:*",
                "cloud9:*",
                "cloudformation:*",
                "cloudhsm:*",
                "cloudtrail:*",
                "codebuild:*",
                "codecommit:*",
                "codedeploy:*",
                "codedeploy-commands-secure:*",
                "codepipeline:*",
                "controltower:*",
                "config:*",
                "dms:*",
                "datasync:*",
                "dataexchange:*",
                "directconnect:*",
                "ds:*",
                "elasticbeanstalk:*",
                "elemental-appliances-software:*",
                "elemental-activations:*",
                "fms:*",
                "network-firewall:*",
                "globalaccelerator:*",
                "glue:*",
                "groundstation:*",
                "health:*",
                "iam:*",
                "sso:*",
                "sso-directory:*",
                "rolesanywhere:*",
                "rds-db:*",
                "iot:*",
                "iot1click:*",
                "iotanalytics:*",
                "iotdeviceadvisor:*",
                "iot-device-tester:*",
                "iotevents:*",
                "iotfleethub:*",
                "iotfleetwise:*",
                "greengrass:*",
                "iotjobsdata:*",
                "iotroborunner:*",
                "iotsitewise:*",
                "iottwinmaker:*",
                "iotwireless:*",
                "kms:*",
                "lakeformation:*",
                "lambda:*",
                "license-manager:*",
                "license-manager-user-subscriptions:*",
                "license-manager-linux-subscriptions:*",
                "networkmanager:*",
                "opsworks:*",
                "opsworks-cm:*",
                "organizations:*",
                "outposts:*",
                "ram:*",
                "resource-groups:*",
                "tag:*",
                "robomaker:*",
                "secretsmanager:*",
                "securityhub:*",
                "securitylake:*",
                "sms:*",
                "serverlessrepo:*",
                "servicecatalog:*",
                "shield:*",
                "snowball:*",
                "snow-device-management:*",
                "states:*",
                "storagegateway:*",
                "ssm:*",
                "ssm-sap:*",
                "transfer:*",
                "trustedadvisor:*",
                "waf:*",
                "waf-regional:*",
                "wafv2:*",
                "xray:*",
                "elasticloadbalancing:*",
                "importexport:*",
                "mediaimport:*",
                "route53resolver:*",
                "elasticache:*",
                "rds:*",
                "sts:*",
                "application-autoscaling:*",
                "firehose:*",
                "route53domains:*",
                "support:*",
                "mgn:*",
                "ssm-guiconnect:*",
                "dlm:*",
                "tiros:*",
                "account:*",
                "servicequotas:List*",
                "route53profiles:*",
                "signer:*",
                "oam:*",
                "pi:*"
            ],
            "Resource": [
                "*"
            ]
        }
    ]
}